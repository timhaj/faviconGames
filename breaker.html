<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favicon Breaker</title>
    <link id="favicon" rel="icon" type="image/png" sizes="16x16">
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
    </style>
</head>
<body>
    <h1>Breaker in Favicon!</h1>
    <p>Use A and D to move the paddle.</p>
    <label for="speedSlider">Ball Speed:</label>
    <input type="range" id="speedSlider" min="1" max="30" value="5" step="1">
    <script>
        const canvas = document.createElement("canvas");
        canvas.width = canvas.height = 16;
        const ctx = canvas.getContext("2d");
        const favicon = document.getElementById("favicon");
        const speedSlider = document.getElementById("speedSlider");

        let paddle = { x: 6, width: 4 };
        let ball = { x: 8, y: 12, dx: 1, dy: -1 };
        let bricks = [];
        const brickRows = 9;
        const brickCols = [4, 3];
        const brickWidth = 4;
        const brickHeight = 1;
        let tickCounter = 0;
        let ballUpdateRate = 12;

        let gameInterval = setInterval(gameLoop, 1000 / 60);

        function initBricks() {
            bricks = [];
            for (let row = 0; row < brickRows; row++) {
                let cols = brickCols[row % 2];
                let offset = (16 - (cols * brickWidth)) / 2;
                for (let col = 0; col < cols; col++) {
                    bricks.push({ x: offset + col * brickWidth, y: row * brickHeight, width: brickWidth, height: brickHeight, active: true });
                }
            }
        }
        initBricks();

        document.addEventListener("keydown", (e) => {
            if (e.key === "a" && paddle.x > 0) paddle.x -= 1;
            if (e.key === "d" && paddle.x + paddle.width < 16) paddle.x += 1;
        });

        speedSlider.addEventListener("input", () => {
            let speedValue = parseInt(speedSlider.value, 10);
            ballUpdateRate = Math.max(1, Math.floor(60 / speedValue));
        });

        function gameLoop() {
            tickCounter++;
            if (tickCounter % ballUpdateRate === 0) {
                moveBall();
                checkCollisions();
                checkWinCondition();
            }
            draw();
        }

        function moveBall() {
            ball.x += ball.dx;
            ball.y += ball.dy;
            if (ball.x <= 0 || ball.x >= 15) ball.dx *= -1;
            if (ball.y <= 0) ball.dy *= -1;
        }

        function checkCollisions() {
            if (ball.y >= 14 && ball.x >= paddle.x && ball.x < paddle.x + paddle.width) {
                ball.dy *= -1;
            } else if (ball.y > 15) {
                resetGame();
            }
            bricks.forEach(brick => {
                if (brick.active && ball.x >= brick.x && ball.x < brick.x + brick.width && ball.y === brick.y) {
                    brick.active = false;
                    ball.dy *= -1;
                }
            });
        }

        function checkWinCondition() {
            if (bricks.every(brick => !brick.active)) {
                resetGame();
            }
        }

        function draw() {
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, 16, 16);
            ctx.fillStyle = "orange";
            bricks.forEach(brick => {
                if (brick.active) ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
            });
            ctx.fillStyle = "green";
            ctx.fillRect(paddle.x, 15, paddle.width, 1);
            ctx.fillStyle = "blue";
            ctx.fillRect(ball.x, ball.y, 1, 1);
            favicon.href = canvas.toDataURL("image/png");
        }

        function resetGame() {
            paddle.x = 6;
            ball = { x: 8, y: 12, dx: 1, dy: -1 };
            initBricks();
        }
    </script>
</body>
</html>
