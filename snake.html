<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favicon Snake</title>
    <link id="favicon" rel="icon" type="image/png" sizes="16x16">
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
    </style>
</head>
<body>
    <h1>Snake in Favicon!</h1>
    <p>Use W, A, S, D to control the snake.</p>
    <label for="speedSlider">Speed:</label>
    <input type="range" id="speedSlider" min="1" max="10" step="0.1" value="1" oninput="updateSpeed()">
    <script>
        const canvas = document.createElement("canvas");
        canvas.width = canvas.height = 16;
        const ctx = canvas.getContext("2d");
        const favicon = document.getElementById("favicon");
        
        let snake = [{x: 8, y: 8}];
        let direction = 'd';
        let nextDirection = 'd';
        let food = spawnFood();
        let speedMultiplier = 1;
        let gameInterval = setInterval(gameLoop, 1000 / speedMultiplier);
        
        document.addEventListener("keydown", (e) => {
            if (['w', 'a', 's', 'd'].includes(e.key)) {
                nextDirection = e.key;
            }
        });
        
        function gameLoop() {
            direction = nextDirection;
            moveSnake();
            if (checkCollision()) {
                resetGame();
                return;
            }
            if (snake.length === 16 * 16) {
                resetGame(); // Player wins by filling the grid
                return;
            }
            if (snake[0].x === food.x && snake[0].y === food.y) {
                snake.push({...snake[snake.length - 1]});
                food = spawnFood();
            }
            draw();
        }
        
        function moveSnake() {
            let head = { ...snake[0] };
            if (direction === 'w') head.y -= 1;
            if (direction === 's') head.y += 1;
            if (direction === 'a') head.x -= 1;
            if (direction === 'd') head.x += 1;
            snake.unshift(head);
            snake.pop();
        }
        
        function checkCollision() {
            if (snake[0].x < 0 || snake[0].x >= 16 || snake[0].y < 0 || snake[0].y >= 16) return true;
            for (let i = 1; i < snake.length; i++) {
                if (snake[i].x === snake[0].x && snake[i].y === snake[0].y) return true;
            }
            return false;
        }
        
        function spawnFood() {
            let emptySpaces = [];
            for (let x = 0; x < 16; x++) {
                for (let y = 0; y < 16; y++) {
                    if (!snake.some(s => s.x === x && s.y === y)) {
                        emptySpaces.push({ x, y });
                    }
                }
            }
            return emptySpaces.length ? emptySpaces[Math.floor(Math.random() * emptySpaces.length)] : null;
        }
        
        function resetGame() {
            snake = [{x: 8, y: 8}];
            direction = 'd';
            nextDirection = 'd';
            food = spawnFood();
        }
        
        function draw() {
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, 16, 16);
            ctx.fillStyle = "green";
            snake.forEach(segment => ctx.fillRect(segment.x, segment.y, 1, 1));
            ctx.fillStyle = "red";
            ctx.fillRect(food.x, food.y, 1, 1);
            favicon.href = canvas.toDataURL("image/png");
        }
        
        function updateSpeed() {
            speedMultiplier = document.getElementById("speedSlider").value;
            clearInterval(gameInterval);
            gameInterval = setInterval(gameLoop, 1000 / speedMultiplier);
        }
    </script>
</body>
</html>
